---
title: Релиз языка программрования NewLang 0.2
date: 2022-08-12
description: >
  A short lead description about this content page. Text here can also be
  **bold** or _italic_ and can even be split over multiple paragraphs.
---

https://habr.com/ru/articles/681960/



![image](https://habrastorage.org/r/w1560/webt/pl/j2/ho/plj2ho0lszvbxr2p1rtgz3ojocc.jpeg)


*NewLang* - это язык программирования высокого уровня в котором можно сочетать стандартные алгоритмические конструкции с декларативным программированием и тензорными вычислениями для задач машинного обучения.

Основной особенностью языка является простой, логичный и не противоречивый синтаксис, который основан не на использовании зарезервированных ключевых слов, а на строгой системе грамматических правил с использованием знаков препинания (в список которых входят и операторы языка).

*NewLang* находится в процессе активного развития и это второй публичный релиз в котором добавлены существенные новые возможности и произошли некоторые изменения по сравнению с [предыдущей версией](https://habr.com/ru/company/timeweb/blog/673176/).

<cut />

## Особенности языка:
- Возможность работы как в режиме интерпретатора, так и компилятора*.
- Динамическая и статическая типизация с возможностью указания типов в явном виде. 
- Статическая типизация является условно строгой (автоматическое приведение типов отсутствует, но допускается преобразование между некоторыми типами данных, например, целое число может быть автоматически преобразовано в вещественное или рациональное, но не наоборот).
- Автоматическое управление памятью.
- ООП в виде явного наследования классов и «утиная» типизация.
- На уровне синтаксиса поддержка нескольких типов функций (обычные и чистые функции без побочных эффектов).
- Необязательные и именованные параметры функций.
- Возможны вставки кода на языке реализации (С/С++)*. 
- Простая интеграция с уже существующими программными библиотеками (в том числе импорт нативных переменных и функций из С/С++). 
- Имеется REPL read-eval-print loop — «цикл: чтение — вычисление — вывод».

## Новые глобальные фичи:
- Добавлены макросы. Теперь можно делать собственные языковые диалекты и использовать более привычную запись алгоритмических конструкций с использование ключевых слов. 
Например, цикл
```
[ cond ] <-> {
      тело цикла
}; 
```
можно записать в более привычный нотации
```
\while (cond) {
      тело цикла
};
```

- Добавлены итераторы для перебора элементов словарей или для запросов к другим контейнерам (например, к базам данных). На уровне базового синтаксиса поддерживается фильтрация данный, включая функциональный аналог LINQ за счет применения функций обратного вызова в качестве условия фильтра.
- Добавлен новый тип данных — рациональные числа с неограниченной точностью. Они записываются в виде обыкновенной дроби, у которой разделитель бекслеш, например единицу  можно записать `1\1`, а число 0.5 как `1\2`.
- Реализован оператор распаковки словаря **…** (многоточие), который можно использовать чтобы передать несколько аргументов при вызове функции или для присвоения значения сразу нескольким переменным.
- Теперь оператор присвоения поддерживает установку значений сразу нескольким переменным. С правой стороны от оператора присвоения может находится одно или несколько значений или оператор распаковки словаря. Причем словарь может быть указан и с левой стороны от оператора присвоения и таким образом можно записать самый простой способ перебора всех его элементов, когда в цикле первый элемент словаря сохраняется в переменную *item*, а из самого словаря удаляется:
```
[ dict ] <-> {  
      item, dict := ... dict; 
};
```

## Изменения в синтаксисе:
- Изменена запись циклов. Вместо двух разных типов с предусловием и постусловие, теперь используется единая форма записи, а тип цикла определяется взаимным расположением условия и его тела.
- Изменены названия арифметических и некоторых других типов данных на более логичные. В именах арифметических типов теперь указан их размер (Int8, Int16 … Float32, Float64 и т.д.).
- Многострочные комментарии стали вложенными


## Подробная информация о языке:
- [Основные правила синтаксиса:](https://newlang.net/syntax.html)
- [Встроенные типы данных:](https://newlang.net/types.html)
- [Операторы и управляющие конструкции:](https://newlang.net/ops.html)

## Примеры кода
<spoiler title="Привет, мир!">
```
#!../output/nlc --eval

# Определение функции hello
hello(str) := { 
    
    # Импорт стандартной C функции
    printf := :Pointer('printf(format:FmtChar, ...):Int32');
    
    # Вызов C функции с проверкой типов аргументов по строке формата
    printf('%s', $str);  

    # Возврат значения из функции hello
     $str;
};

hello('Привет, мир!'); # Вызвать функцию
```
Вывод (первая строка выводится с помощью printf, а вторая - возвращаемое значение функции hello):
```
    Привет, мир!
    Привет, мир!
``` </spoiler>

<spoiler title="Пример скрипта для вычисления факториала 1000">
```
#!../output/nlc --eval

@fact := 1\1;  # Рациональное число без ограничения точности
@mult := 1000..1..-1?; # Сделать из диапазона итератор для множителей от 1000 до 2
[mult ?!] <-> {      # Цикл, пока не закончатся данные итератора
    # Получить текущий множитель и перейти на следующий элемент итератора
    fact *= mult !; 
};
fact # Вывести итоговый результат
```
Вывод:
```
402387260077093773543702433923003985719374864210714632543799910429938512398629
020592044208486969404800479988610197196058631666872994808558901323829669944590
997424504087073759918823627727188732519779505950995276120874975462497043601418
278094646496291056393887437886487337119181045825783647849977012476632889835955
735432513185323958463075557409114262417474349347553428646576611667797396668820
291207379143853719588249808126867838374559731746136085379534524221586593201928
090878297308431392844403281231558611036976801357304216168747609675871348312025
478589320767169132448426236131412508780208000261683151027341827977704784635868
170164365024153691398281264810213092761244896359928705114964975419909342221566
832572080821333186116811553615836546984046708975602900950537616475847728421889
679646244945160765353408198901385442487984959953319101723355556602139450399736
280750137837615307127761926849034352625200015888535147331611702103968175921510
907788019393178114194545257223865541461062892187960223838971476088506276862967
146674697562911234082439208160153780889893964518263243671616762179168909779911
903754031274622289988005195444414282012187361745992642956581746628302955570299
024324153181617210465832036786906117260158783520751516284225540265170483304226
143974286933061690897968482590125458327168226458066526769958652682272807075781
391858178889652208164348344825993266043367660176999612831860788386150279465955
131156552036093988180612138558600301435694527224206344631797460594682573103790
084024432438465657245014402821885252470935190620929023136493273497565513958720
559654228749774011413346962715422845862377387538230483865688976461927383814900
140767310446640259899490222221765904339901886018566526485061799702356193897017
860040811889729918311021171229845901641921068884387121855646124960798722908519
296819372388642614839657382291123125024186649353143970137428531926649875337218
940694281434118520158014123344828015051399694290153483077644569099073152433278
288269864602789864321139083506217095002597389863554277196742822248757586765752
344220207573630569498825087968928162753848863396909959826280956121450994871701
244516461260379029309120889086942028510640182154399457156805941872748998094254
742173582401063677404595741785160829230135358081840096996372524230560855903700
624271243416909004153690105933983835777939410970027753472000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000\1
```  </spoiler>

## Как посмотреть?
- [Загрузить собранный REPL и тесты (пока только под Ubuntu)](https://github.com/rsashka/newlang/releases/download/v0.2.0/nlc_bin.tar.xz)
- Для запуска бинарных файлов потребуются разделяемые библиотеки libLLVM-13 и libtorch: [архив только с нужными библиотеками](https://github.com/rsashka/newlang/releases/download/v0.2.0/nlc_so.tar.xz).
- Так же все можно собрать напрямую из исходников по инструкции в [репозитории](https://github.com/rsashka/newlang)